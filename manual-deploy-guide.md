# 🖥️ AWS Management Console 手動デプロイガイド

## 📋 前提条件

### 1. AWSアカウントの準備
- [AWS公式サイト](https://aws.amazon.com/)でアカウント作成
- クレジットカードの登録
- 電話番号の認証

### 2. WARファイルの準備
EclipseでプロジェクトをエクスポートしてWARファイルを作成：

#### Eclipseでの手順
1. **プロジェクトを右クリック** → **Export**
2. **Web** → **WAR file** を選択
3. **Destination**: `AozoraBookSelector.war` として保存
4. **Finish** をクリック

#### または、手動でWARファイルを作成
```bash
# プロジェクトディレクトリで
mkdir -p temp/WEB-INF/classes
mkdir -p temp/WEB-INF/lib

# ファイルをコピー
cp -r src/main/webapp/* temp/
cp -r src/main/resources/* temp/WEB-INF/
cp src/main/webapp/WEB-INF/lib/* temp/WEB-INF/lib/

# WARファイルを作成
cd temp
jar -cf ../AozoraBookSelector.war .
cd ..
rm -rf temp
```

## 🚀 手動デプロイ手順

### ステップ1: AWS Management Consoleにログイン

1. [AWS Management Console](https://console.aws.amazon.com/) にアクセス
2. AWSアカウントでログイン
3. 右上のリージョンを **「アジアパシフィック（東京）」** に設定

### ステップ2: Elastic Beanstalkサービスに移動

1. 検索バーに **「Elastic Beanstalk」** と入力
2. **Elastic Beanstalk** をクリック

### ステップ3: 新しいアプリケーションを作成

1. **「新しいアプリケーションを作成」** ボタンをクリック
2. 以下の情報を入力：
   - **アプリケーション名**: `aozora-book-selector`
   - **説明**: `青空文庫ランダム書籍選択システム`

### ステップ4: プラットフォームを選択

1. **「プラットフォーム」** セクションで以下を選択：
   - **プラットフォーム**: `Web server environment`
   - **プラットフォーム**: `Tomcat`
   - **プラットフォームブランチ**: `Tomcat 10 Corretto 17`
   - **プラットフォームバージョン**: 最新版（推奨）

### ステップ5: アプリケーションコードをアップロード

1. **「アプリケーションコード」** セクションで：
   - **「アップロード」** を選択
   - **「ファイルを選択」** をクリック
   - `AozoraBookSelector.war` ファイルを選択
   - **「アップロード」** をクリック

### ステップ6: 環境設定

1. **「環境情報」** セクション：
   - **環境名**: `aozora-book-selector-prod`
   - **ドメイン**: 自動生成（またはカスタムドメイン）

2. **「設定プリセット」** セクション：
   - **「単一インスタンス（無料利用枠）」** を選択

### ステップ7: 詳細設定（オプション）

1. **「設定の詳細」** をクリック
2. **「インスタンス」** セクション：
   - **インスタンスタイプ**: `t3.micro`（無料枠）
   - **EC2 セキュリティグループ**: デフォルト

3. **「容量」** セクション：
   - **環境タイプ**: `単一インスタンス`
   - **インスタンス**: `1`

4. **「ロードバランサー」** セクション：
   - **ロードバランサータイプ**: `Application Load Balancer`

### ステップ8: デプロイ実行

1. **「アプリケーションを作成」** ボタンをクリック
2. デプロイが開始されます（約5-10分）

### ステップ9: デプロイ完了確認

1. **「イベント」** タブでデプロイ状況を確認
2. **「正常」** と表示されたら完了
3. **アプリケーションURL** をクリックして動作確認

## 🌐 アプリケーションURLの確認

デプロイ完了後、以下のようなURLが表示されます：
```
https://aozora-book-selector-prod.ap-northeast-1.elasticbeanstalk.com
```

## 🔧 環境設定のカスタマイズ

### 環境変数の設定

1. **Elastic Beanstalkコンソール** → **環境** → **設定**
2. **「ソフトウェア」** セクションをクリック
3. **「環境プロパティ」** で以下を追加：
   - `JAVA_HOME`: `/usr/lib/jvm/java-17-amazon-corretto`
   - `JVM_OPTS`: `-Xms256m -Xmx512m`

### セキュリティグループの設定

1. **「セキュリティ」** セクションをクリック
2. **「EC2 セキュリティグループ」** を選択
3. 必要に応じてポート設定を調整

## 📊 監視とログ

### CloudWatchログの確認

1. **「ログ」** タブをクリック
2. **「最新のログを要求」** をクリック
3. ログファイルをダウンロードして確認

### メトリクスの確認

1. **「監視」** タブをクリック
2. CPU使用率、メモリ使用率、リクエスト数などを確認

## 🔒 セキュリティ設定

### HTTPSの設定

1. **「設定」** → **「ロードバランサー」**
2. **「リスナー」** セクションでHTTPSを追加
3. ACMでSSL証明書を取得・設定

### ドメインの設定

1. Route 53でドメインを購入
2. **「設定」** → **「ドメイン」**
3. カスタムドメインを設定

## 💰 コスト監視

### 請求アラートの設定

1. **AWS Billing** サービスに移動
2. **「請求アラート」** → **「アラートを作成」**
3. 月額予算を設定（例：$30）

### コスト最適化

1. **AWS Trusted Advisor** で推奨事項を確認
2. 未使用リソースの削除
3. リザーブドインスタンスの検討

## 🚨 トラブルシューティング

### よくある問題

1. **デプロイ失敗**
   - **ログ** タブでエラーを確認
   - WARファイルの整合性を確認
   - メモリ不足の場合はインスタンスサイズを増加

2. **アプリケーションが起動しない**
   - **イベント** タブでエラーを確認
   - **ログ** タブで詳細ログを確認
   - ポート設定を確認

3. **パフォーマンスの問題**
   - **監視** タブでメトリクスを確認
   - インスタンスサイズを増加
   - ロードバランサーの設定を確認

### ログの確認方法

1. **「ログ」** タブをクリック
2. **「最新のログを要求」** をクリック
3. 以下のログファイルを確認：
   - `var/log/tomcat10/catalina.out`
   - `var/log/eb-engine.log`
   - `var/log/nginx/access.log`

## 📞 サポート

### AWSサポート
- **Developer Support**: $29/月
- **Business Support**: $100/月
- **Enterprise Support**: $15,000/月

### 無料サポート
- [AWS Developer Forums](https://forums.aws.amazon.com/)
- [AWS Documentation](https://docs.aws.amazon.com/)
- [AWS re:Post](https://repost.aws/)

## 🎉 デプロイ完了後の確認事項

### 動作確認チェックリスト

- [ ] アプリケーションURLにアクセス可能
- [ ] ランダム書籍選択機能が動作
- [ ] ログイン・登録機能が動作
- [ ] レスポンシブデザインが正常表示
- [ ] 外部リンク（青空文庫）が正常動作

### セキュリティ確認

- [ ] HTTPSが有効
- [ ] セキュリティグループが適切に設定
- [ ] 不要なポートが閉じられている

### パフォーマンス確認

- [ ] ページ読み込み速度が適切
- [ ] メモリ使用率が正常範囲
- [ ] CPU使用率が正常範囲

---

**デプロイが完了したら、アプリケーションURLで動作確認を行ってください！** 🌐✨ 